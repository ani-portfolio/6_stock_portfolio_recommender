# prefect.yaml
name: stock-portfolio-recommender
prefect-version: 3.4.6

# Build section - no build needed for Python flows
build: null

# Push section - no push needed since code is on GitHub
push: null

# Pull section - clone from GitHub and install dependencies
pull:
  - prefect.deployments.steps.git_clone:
      id: clone-step
      repository: https://github.com/ani-portfolio/6_stock_portfolio_recommender.git
      branch: feature/prefect
  - prefect.deployments.steps.pip_install_requirements:
      requirements_file: requirements.txt
      directory: "{{ clone-step.directory }}"
      stream_output: false

# Define deployments
deployments:
  - name: update-stock-data-bigquery
    version: 1.0.0
    tags:
      - stock-data
      - bigquery
    description: Updates stock data in BigQuery every 6 hours
    schedule:
      cron: "0 */6 * * *"
      timezone: "UTC"
    entrypoint: scripts/update_stock_data.py:main
    work_pool:
      name: default-work-pool
      job_variables: {}
    parameters: {}